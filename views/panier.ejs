<%- include("header") %>
<link rel="stylesheet" href="/CSS/panier.css">

<div class="page_panier">
  <h1>Mon Panier</h1>

  <% if (panier && panier.length > 0) { %>
    <div class="container_panier">
      <div class="liste_produits">
        <% panier.forEach(function(item) { %>
          <div class="item_panier">
            <img src="<%= item.image %>" alt="<%= item.marque %> <%= item.modele %>">
            
            <div class="info_item">
              <h3><%= item.marque %> <%= item.modele %></h3>
              <p class="description"><%= item.description %></p>
              
              <% if (item.date_debut && item.date_fin) { %>
                <p class="dates">
                  Du <%= new Date(item.date_debut).toLocaleDateString('fr-FR') %> 
                  au <%= new Date(item.date_fin).toLocaleDateString('fr-FR') %>
                </p>
                <p class="duree"><%= item.jours %> jour<%= item.jours > 1 ? 's' : '' %></p>
              <% } %>
              
              <% if (item.quantite > 1) { %>
                <p class="quantite">Quantité : <%= item.quantite %></p>
              <% } %>
              
              <p class="prix"><%= item.prix_location.toFixed(2) %>€ / jour</p>
              <p class="prix_total"><strong>Total : <%= item.prix_total.toFixed(2) %>€</strong></p>
            </div>

            <form action="/panier/supprimer/<%= item.id %>" method="post" class="form_supprimer">
              <button type="submit" class="btn_supprimer">✕</button>
            </form>
          </div>
        <% }); %>
      </div>

      <div class="recap_panier">
        <h2>Récapitulatif</h2>
        
        <div class="details_recap">
          <p>Nombre d'articles : <strong><%= panier.length %></strong></p>
          <p class="total">Total : <strong><%= total %>€</strong></p>
        </div>

        <a href="/paiement" class="btn_payer">Procéder au paiement</a>
        <a href="/catalogue_produit" class="btn_continuer">Continuer mes achats</a>
      </div>
    </div>
  <% } else { %>
    <div class="panier_vide">
      <p>Votre panier est vide</p>
      <a href="/catalogue_produit" class="btn_catalogue">Découvrir nos produits</a>
    </div>
  <% } %>
</div>

<%- include("footer") %>